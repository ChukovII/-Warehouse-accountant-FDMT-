{% extends "base.html" %}

{% block content %}
<div class="mt-5">
    <h1 class="mb-4">
        üìú –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π: **{{ material.name }}**
        <small class="text-muted fs-5 ms-3">(–¢–µ–∫—É—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫: {{ material.current_quantity }} {{ material.unit }})</small>
    </h1>

    <a href="{% url 'log_operation' material.pk %}" class="btn btn-primary mb-3 me-2">–î–æ–±–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é</a>
    <a href="{% url 'material_list' %}" class="btn btn-secondary mb-3">–ù–∞–∑–∞–¥ –∫ —Å–∫–ª–∞–¥—É</a>

    <div class="card shadow">
        <div class="card-body">
            <table class="table table-hover table-striped">
                <thead class="table-dark">
                    <tr>
                        <th>–î–∞—Ç–∞</th>
                        <th>–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏</th>
                        <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                        <th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th>
                        <th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in history %}
                    {% comment %}
                    –ò—Å–ø–æ–ª—å–∑—É–µ–º get_operation_type_display, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∫—Ä–∞—Å–∏–≤–æ–µ –∏–º—è
                    ('–ü—Ä–∏—Ö–æ–¥' –≤–º–µ—Å—Ç–æ 'IN', '–†–∞—Å—Ö–æ–¥' –≤–º–µ—Å—Ç–æ 'OUT').
                    {% endcomment %}

                    {# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å –¥–ª—è —Ü–≤–µ—Ç–æ–≤–æ–π –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏ —Å—Ç—Ä–æ–∫–∏ #}
                    {% if item.operation_type == 'IN' %}
                        {% with row_class='table-success' %}{% endwith %}
                    {% elif item.operation_type == 'OUT' %}
                        {% with row_class='table-warning' %}{% endwith %}
                    {% elif item.operation_type == 'DISP' %}
                        {% with row_class='table-danger' %}{% endwith %}
                    {% else %}
                        {% with row_class='table-light' %}{% endwith %}
                    {% endif %}

                    <tr class="{{ row_class }}">
    <td>{{ item.date|date:"d.m.Y" }}</td>
    <td>
        {% if item.operation_type == 'IN' %}
            <span class="text-success fw-bold">
                <i class="fas fa-arrow-up"></i> –ü—Ä–∏—Ö–æ–¥
            </span>
        {% elif item.operation_type == 'OUT' %}
            <span class="text-warning fw-bold">
                <i class="fas fa-arrow-down"></i> –†–∞—Å—Ö–æ–¥
            </span>
        {% elif item.operation_type == 'DISP' %}
            <span class="text-danger fw-bold">
                <i class="fas fa-trash-alt"></i> –°–ø–∏—Å–∞–Ω–∏–µ
            </span>
        {% else %}
            {{ item.get_operation_type_display }}
        {% endif %}
    </td>
    <td class="fw-bold">
        {% if item.operation_type == 'IN' %}
            <span class="text-success">+{{ item.quantity }}</span>
        {% else %}
            <span class="text-danger">-{{ item.quantity }}</span>
        {% endif %}
        {{ material.unit }}
    </td>

    <td>{{ item.user.username|default:"–°–∏—Å—Ç–µ–º–∞" }}</td>
    <td>{{ item.comment|default:"-" }}</td>
</tr>
                    {% empty %}
                    <tr>
                        <td colspan="5" class="text-center">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –æ–± –æ–ø–µ—Ä–∞—Ü–∏—è—Ö —Å —ç—Ç–∏–º –º–∞—Ç–µ—Ä–∏–∞–ª–æ–º.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

</div>
{% endblock content %}